/**
 * @license
 * Copyright Google Inc. All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
import * as tslib_1 from "tslib";
import { Inject, Injectable, InjectionToken, LOCALE_ID, Optional } from '@angular/core';
import { Plural, getLocalePluralCase } from './locale_data_api';
/**
 * @deprecated from v5
 */
import * as ɵngcc0 from '@angular/core';
export var DEPRECATED_PLURAL_FN = new InjectionToken('UseV4Plurals');
/**
 * @publicApi
 */
var NgLocalization = /** @class */ (function () {
    function NgLocalization() {
    }
    return NgLocalization;
}());
export { NgLocalization };
/**
 * Returns the plural category for a given value.
 * - "=value" when the case exists,
 * - the plural category otherwise
 */
export function getPluralCategory(value, cases, ngLocalization, locale) {
    var key = "=" + value;
    if (cases.indexOf(key) > -1) {
        return key;
    }
    key = ngLocalization.getPluralCategory(value, locale);
    if (cases.indexOf(key) > -1) {
        return key;
    }
    if (cases.indexOf('other') > -1) {
        return 'other';
    }
    throw new Error("No plural message found for value \"" + value + "\"");
}
/**
 * Returns the plural case based on the locale
 *
 * @publicApi
 */
var NgLocaleLocalization = /** @class */ (function (_super) {
    tslib_1.__extends(NgLocaleLocalization, _super);
    function NgLocaleLocalization(locale, 
    /** @deprecated from v5 */
    deprecatedPluralFn) {
        var _this = _super.call(this) || this;
        _this.locale = locale;
        _this.deprecatedPluralFn = deprecatedPluralFn;
        return _this;
    }
    NgLocaleLocalization.prototype.getPluralCategory = function (value, locale) {
        var plural = this.deprecatedPluralFn ? this.deprecatedPluralFn(locale || this.locale, value) :
            getLocalePluralCase(locale || this.locale)(value);
        switch (plural) {
            case Plural.Zero:
                return 'zero';
            case Plural.One:
                return 'one';
            case Plural.Two:
                return 'two';
            case Plural.Few:
                return 'few';
            case Plural.Many:
                return 'many';
            default:
                return 'other';
        }
    };
    NgLocaleLocalization = tslib_1.__decorate([
        tslib_1.__param(0, Inject(LOCALE_ID)),
        tslib_1.__param(1, Optional()), tslib_1.__param(1, Inject(DEPRECATED_PLURAL_FN)),
        tslib_1.__metadata("design:paramtypes", [String, Object])
    ], NgLocaleLocalization);
NgLocaleLocalization.ngInjectableDef = ɵngcc0.ɵɵdefineInjectable({ token: NgLocaleLocalization, factory: function NgLocaleLocalization_Factory(t) { return new (t || NgLocaleLocalization)(ɵngcc0.ɵɵinject(LOCALE_ID), ɵngcc0.ɵɵinject(DEPRECATED_PLURAL_FN, 8)); }, providedIn: null });
/*@__PURE__*/ ɵngcc0.ɵsetClassMetadata(NgLocaleLocalization, [{
        type: Injectable
    }], function () { return [{ type: String, decorators: [{
                type: Inject,
                args: [LOCALE_ID]
            }] }, { type: Object, decorators: [{
                type: Optional
            }, {
                type: Inject,
                args: [DEPRECATED_PLURAL_FN]
            }] }]; }, { getPluralCategory: [] });
    return NgLocaleLocalization;
}(NgLocalization));
export { NgLocaleLocalization };
/**
 * Returns the plural case based on the locale
 *
 * @deprecated from v5 the plural case function is in locale data files common/locales/*.ts
 * @publicApi
 */
export function getPluralCase(locale, nLike) {
    // TODO(vicb): lazy compute
    if (typeof nLike === 'string') {
        nLike = parseInt(nLike, 10);
    }
    var n = nLike;
    var nDecimal = n.toString().replace(/^[^.]*\.?/, '');
    var i = Math.floor(Math.abs(n));
    var v = nDecimal.length;
    var f = parseInt(nDecimal, 10);
    var t = parseInt(n.toString().replace(/^[^.]*\.?|0+$/g, ''), 10) || 0;
    var lang = locale.split('-')[0].toLowerCase();
    switch (lang) {
        case 'af':
        case 'asa':
        case 'az':
        case 'bem':
        case 'bez':
        case 'bg':
        case 'brx':
        case 'ce':
        case 'cgg':
        case 'chr':
        case 'ckb':
        case 'ee':
        case 'el':
        case 'eo':
        case 'es':
        case 'eu':
        case 'fo':
        case 'fur':
        case 'gsw':
        case 'ha':
        case 'haw':
        case 'hu':
        case 'jgo':
        case 'jmc':
        case 'ka':
        case 'kk':
        case 'kkj':
        case 'kl':
        case 'ks':
        case 'ksb':
        case 'ky':
        case 'lb':
        case 'lg':
        case 'mas':
        case 'mgo':
        case 'ml':
        case 'mn':
        case 'nb':
        case 'nd':
        case 'ne':
        case 'nn':
        case 'nnh':
        case 'nyn':
        case 'om':
        case 'or':
        case 'os':
        case 'ps':
        case 'rm':
        case 'rof':
        case 'rwk':
        case 'saq':
        case 'seh':
        case 'sn':
        case 'so':
        case 'sq':
        case 'ta':
        case 'te':
        case 'teo':
        case 'tk':
        case 'tr':
        case 'ug':
        case 'uz':
        case 'vo':
        case 'vun':
        case 'wae':
        case 'xog':
            if (n === 1)
                return Plural.One;
            return Plural.Other;
        case 'ak':
        case 'ln':
        case 'mg':
        case 'pa':
        case 'ti':
            if (n === Math.floor(n) && n >= 0 && n <= 1)
                return Plural.One;
            return Plural.Other;
        case 'am':
        case 'as':
        case 'bn':
        case 'fa':
        case 'gu':
        case 'hi':
        case 'kn':
        case 'mr':
        case 'zu':
            if (i === 0 || n === 1)
                return Plural.One;
            return Plural.Other;
        case 'ar':
            if (n === 0)
                return Plural.Zero;
            if (n === 1)
                return Plural.One;
            if (n === 2)
                return Plural.Two;
            if (n % 100 === Math.floor(n % 100) && n % 100 >= 3 && n % 100 <= 10)
                return Plural.Few;
            if (n % 100 === Math.floor(n % 100) && n % 100 >= 11 && n % 100 <= 99)
                return Plural.Many;
            return Plural.Other;
        case 'ast':
        case 'ca':
        case 'de':
        case 'en':
        case 'et':
        case 'fi':
        case 'fy':
        case 'gl':
        case 'it':
        case 'nl':
        case 'sv':
        case 'sw':
        case 'ur':
        case 'yi':
            if (i === 1 && v === 0)
                return Plural.One;
            return Plural.Other;
        case 'be':
            if (n % 10 === 1 && !(n % 100 === 11))
                return Plural.One;
            if (n % 10 === Math.floor(n % 10) && n % 10 >= 2 && n % 10 <= 4 &&
                !(n % 100 >= 12 && n % 100 <= 14))
                return Plural.Few;
            if (n % 10 === 0 || n % 10 === Math.floor(n % 10) && n % 10 >= 5 && n % 10 <= 9 ||
                n % 100 === Math.floor(n % 100) && n % 100 >= 11 && n % 100 <= 14)
                return Plural.Many;
            return Plural.Other;
        case 'br':
            if (n % 10 === 1 && !(n % 100 === 11 || n % 100 === 71 || n % 100 === 91))
                return Plural.One;
            if (n % 10 === 2 && !(n % 100 === 12 || n % 100 === 72 || n % 100 === 92))
                return Plural.Two;
            if (n % 10 === Math.floor(n % 10) && (n % 10 >= 3 && n % 10 <= 4 || n % 10 === 9) &&
                !(n % 100 >= 10 && n % 100 <= 19 || n % 100 >= 70 && n % 100 <= 79 ||
                    n % 100 >= 90 && n % 100 <= 99))
                return Plural.Few;
            if (!(n === 0) && n % 1e6 === 0)
                return Plural.Many;
            return Plural.Other;
        case 'bs':
        case 'hr':
        case 'sr':
            if (v === 0 && i % 10 === 1 && !(i % 100 === 11) || f % 10 === 1 && !(f % 100 === 11))
                return Plural.One;
            if (v === 0 && i % 10 === Math.floor(i % 10) && i % 10 >= 2 && i % 10 <= 4 &&
                !(i % 100 >= 12 && i % 100 <= 14) ||
                f % 10 === Math.floor(f % 10) && f % 10 >= 2 && f % 10 <= 4 &&
                    !(f % 100 >= 12 && f % 100 <= 14))
                return Plural.Few;
            return Plural.Other;
        case 'cs':
        case 'sk':
            if (i === 1 && v === 0)
                return Plural.One;
            if (i === Math.floor(i) && i >= 2 && i <= 4 && v === 0)
                return Plural.Few;
            if (!(v === 0))
                return Plural.Many;
            return Plural.Other;
        case 'cy':
            if (n === 0)
                return Plural.Zero;
            if (n === 1)
                return Plural.One;
            if (n === 2)
                return Plural.Two;
            if (n === 3)
                return Plural.Few;
            if (n === 6)
                return Plural.Many;
            return Plural.Other;
        case 'da':
            if (n === 1 || !(t === 0) && (i === 0 || i === 1))
                return Plural.One;
            return Plural.Other;
        case 'dsb':
        case 'hsb':
            if (v === 0 && i % 100 === 1 || f % 100 === 1)
                return Plural.One;
            if (v === 0 && i % 100 === 2 || f % 100 === 2)
                return Plural.Two;
            if (v === 0 && i % 100 === Math.floor(i % 100) && i % 100 >= 3 && i % 100 <= 4 ||
                f % 100 === Math.floor(f % 100) && f % 100 >= 3 && f % 100 <= 4)
                return Plural.Few;
            return Plural.Other;
        case 'ff':
        case 'fr':
        case 'hy':
        case 'kab':
            if (i === 0 || i === 1)
                return Plural.One;
            return Plural.Other;
        case 'fil':
            if (v === 0 && (i === 1 || i === 2 || i === 3) ||
                v === 0 && !(i % 10 === 4 || i % 10 === 6 || i % 10 === 9) ||
                !(v === 0) && !(f % 10 === 4 || f % 10 === 6 || f % 10 === 9))
                return Plural.One;
            return Plural.Other;
        case 'ga':
            if (n === 1)
                return Plural.One;
            if (n === 2)
                return Plural.Two;
            if (n === Math.floor(n) && n >= 3 && n <= 6)
                return Plural.Few;
            if (n === Math.floor(n) && n >= 7 && n <= 10)
                return Plural.Many;
            return Plural.Other;
        case 'gd':
            if (n === 1 || n === 11)
                return Plural.One;
            if (n === 2 || n === 12)
                return Plural.Two;
            if (n === Math.floor(n) && (n >= 3 && n <= 10 || n >= 13 && n <= 19))
                return Plural.Few;
            return Plural.Other;
        case 'gv':
            if (v === 0 && i % 10 === 1)
                return Plural.One;
            if (v === 0 && i % 10 === 2)
                return Plural.Two;
            if (v === 0 &&
                (i % 100 === 0 || i % 100 === 20 || i % 100 === 40 || i % 100 === 60 || i % 100 === 80))
                return Plural.Few;
            if (!(v === 0))
                return Plural.Many;
            return Plural.Other;
        case 'he':
            if (i === 1 && v === 0)
                return Plural.One;
            if (i === 2 && v === 0)
                return Plural.Two;
            if (v === 0 && !(n >= 0 && n <= 10) && n % 10 === 0)
                return Plural.Many;
            return Plural.Other;
        case 'is':
            if (t === 0 && i % 10 === 1 && !(i % 100 === 11) || !(t === 0))
                return Plural.One;
            return Plural.Other;
        case 'ksh':
            if (n === 0)
                return Plural.Zero;
            if (n === 1)
                return Plural.One;
            return Plural.Other;
        case 'kw':
        case 'naq':
        case 'se':
        case 'smn':
            if (n === 1)
                return Plural.One;
            if (n === 2)
                return Plural.Two;
            return Plural.Other;
        case 'lag':
            if (n === 0)
                return Plural.Zero;
            if ((i === 0 || i === 1) && !(n === 0))
                return Plural.One;
            return Plural.Other;
        case 'lt':
            if (n % 10 === 1 && !(n % 100 >= 11 && n % 100 <= 19))
                return Plural.One;
            if (n % 10 === Math.floor(n % 10) && n % 10 >= 2 && n % 10 <= 9 &&
                !(n % 100 >= 11 && n % 100 <= 19))
                return Plural.Few;
            if (!(f === 0))
                return Plural.Many;
            return Plural.Other;
        case 'lv':
        case 'prg':
            if (n % 10 === 0 || n % 100 === Math.floor(n % 100) && n % 100 >= 11 && n % 100 <= 19 ||
                v === 2 && f % 100 === Math.floor(f % 100) && f % 100 >= 11 && f % 100 <= 19)
                return Plural.Zero;
            if (n % 10 === 1 && !(n % 100 === 11) || v === 2 && f % 10 === 1 && !(f % 100 === 11) ||
                !(v === 2) && f % 10 === 1)
                return Plural.One;
            return Plural.Other;
        case 'mk':
            if (v === 0 && i % 10 === 1 || f % 10 === 1)
                return Plural.One;
            return Plural.Other;
        case 'mt':
            if (n === 1)
                return Plural.One;
            if (n === 0 || n % 100 === Math.floor(n % 100) && n % 100 >= 2 && n % 100 <= 10)
                return Plural.Few;
            if (n % 100 === Math.floor(n % 100) && n % 100 >= 11 && n % 100 <= 19)
                return Plural.Many;
            return Plural.Other;
        case 'pl':
            if (i === 1 && v === 0)
                return Plural.One;
            if (v === 0 && i % 10 === Math.floor(i % 10) && i % 10 >= 2 && i % 10 <= 4 &&
                !(i % 100 >= 12 && i % 100 <= 14))
                return Plural.Few;
            if (v === 0 && !(i === 1) && i % 10 === Math.floor(i % 10) && i % 10 >= 0 && i % 10 <= 1 ||
                v === 0 && i % 10 === Math.floor(i % 10) && i % 10 >= 5 && i % 10 <= 9 ||
                v === 0 && i % 100 === Math.floor(i % 100) && i % 100 >= 12 && i % 100 <= 14)
                return Plural.Many;
            return Plural.Other;
        case 'pt':
            if (n === Math.floor(n) && n >= 0 && n <= 2 && !(n === 2))
                return Plural.One;
            return Plural.Other;
        case 'ro':
            if (i === 1 && v === 0)
                return Plural.One;
            if (!(v === 0) || n === 0 ||
                !(n === 1) && n % 100 === Math.floor(n % 100) && n % 100 >= 1 && n % 100 <= 19)
                return Plural.Few;
            return Plural.Other;
        case 'ru':
        case 'uk':
            if (v === 0 && i % 10 === 1 && !(i % 100 === 11))
                return Plural.One;
            if (v === 0 && i % 10 === Math.floor(i % 10) && i % 10 >= 2 && i % 10 <= 4 &&
                !(i % 100 >= 12 && i % 100 <= 14))
                return Plural.Few;
            if (v === 0 && i % 10 === 0 ||
                v === 0 && i % 10 === Math.floor(i % 10) && i % 10 >= 5 && i % 10 <= 9 ||
                v === 0 && i % 100 === Math.floor(i % 100) && i % 100 >= 11 && i % 100 <= 14)
                return Plural.Many;
            return Plural.Other;
        case 'shi':
            if (i === 0 || n === 1)
                return Plural.One;
            if (n === Math.floor(n) && n >= 2 && n <= 10)
                return Plural.Few;
            return Plural.Other;
        case 'si':
            if (n === 0 || n === 1 || i === 0 && f === 1)
                return Plural.One;
            return Plural.Other;
        case 'sl':
            if (v === 0 && i % 100 === 1)
                return Plural.One;
            if (v === 0 && i % 100 === 2)
                return Plural.Two;
            if (v === 0 && i % 100 === Math.floor(i % 100) && i % 100 >= 3 && i % 100 <= 4 || !(v === 0))
                return Plural.Few;
            return Plural.Other;
        case 'tzm':
            if (n === Math.floor(n) && n >= 0 && n <= 1 || n === Math.floor(n) && n >= 11 && n <= 99)
                return Plural.One;
            return Plural.Other;
        // When there is no specification, the default is always "other"
        // Spec: http://cldr.unicode.org/index/cldr-spec/plural-rules
        // > other (required—general plural form — also used if the language only has a single form)
        default:
            return Plural.Other;
    }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImQ6L1Byb2plY3RzL1Rlc3RQcm9qZWN0L0NoYXJnaW5nL0NoYXJnaW5nL2Zyb250ZW5kL25vZGVfbW9kdWxlcy9AYW5ndWxhci9jb21tb24vZXNtNS9zcmMvaTE4bi9sb2NhbGl6YXRpb24uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Ozs7O0FBYUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OytDQThEK0MsQUFDMUI7Ozs7Ozs7Ozs7Ozs7Ozs7aURBSVEiLCJmaWxlIjoibG9jYWxpemF0aW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCBHb29nbGUgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gKlxyXG4gKiBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhbiBNSVQtc3R5bGUgbGljZW5zZSB0aGF0IGNhbiBiZVxyXG4gKiBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGF0IGh0dHBzOi8vYW5ndWxhci5pby9saWNlbnNlXHJcbiAqL1xyXG5pbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBJbmplY3QsIEluamVjdGFibGUsIEluamVjdGlvblRva2VuLCBMT0NBTEVfSUQsIE9wdGlvbmFsIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFBsdXJhbCwgZ2V0TG9jYWxlUGx1cmFsQ2FzZSB9IGZyb20gJy4vbG9jYWxlX2RhdGFfYXBpJztcclxuLyoqXHJcbiAqIEBkZXByZWNhdGVkIGZyb20gdjVcclxuICovXHJcbmV4cG9ydCB2YXIgREVQUkVDQVRFRF9QTFVSQUxfRk4gPSBuZXcgSW5qZWN0aW9uVG9rZW4oJ1VzZVY0UGx1cmFscycpO1xyXG4vKipcclxuICogQHB1YmxpY0FwaVxyXG4gKi9cclxudmFyIE5nTG9jYWxpemF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTmdMb2NhbGl6YXRpb24oKSB7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gTmdMb2NhbGl6YXRpb247XHJcbn0oKSk7XHJcbmV4cG9ydCB7IE5nTG9jYWxpemF0aW9uIH07XHJcbi8qKlxyXG4gKiBSZXR1cm5zIHRoZSBwbHVyYWwgY2F0ZWdvcnkgZm9yIGEgZ2l2ZW4gdmFsdWUuXHJcbiAqIC0gXCI9dmFsdWVcIiB3aGVuIHRoZSBjYXNlIGV4aXN0cyxcclxuICogLSB0aGUgcGx1cmFsIGNhdGVnb3J5IG90aGVyd2lzZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFBsdXJhbENhdGVnb3J5KHZhbHVlLCBjYXNlcywgbmdMb2NhbGl6YXRpb24sIGxvY2FsZSkge1xyXG4gICAgdmFyIGtleSA9IFwiPVwiICsgdmFsdWU7XHJcbiAgICBpZiAoY2FzZXMuaW5kZXhPZihrZXkpID4gLTEpIHtcclxuICAgICAgICByZXR1cm4ga2V5O1xyXG4gICAgfVxyXG4gICAga2V5ID0gbmdMb2NhbGl6YXRpb24uZ2V0UGx1cmFsQ2F0ZWdvcnkodmFsdWUsIGxvY2FsZSk7XHJcbiAgICBpZiAoY2FzZXMuaW5kZXhPZihrZXkpID4gLTEpIHtcclxuICAgICAgICByZXR1cm4ga2V5O1xyXG4gICAgfVxyXG4gICAgaWYgKGNhc2VzLmluZGV4T2YoJ290aGVyJykgPiAtMSkge1xyXG4gICAgICAgIHJldHVybiAnb3RoZXInO1xyXG4gICAgfVxyXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gcGx1cmFsIG1lc3NhZ2UgZm91bmQgZm9yIHZhbHVlIFxcXCJcIiArIHZhbHVlICsgXCJcXFwiXCIpO1xyXG59XHJcbi8qKlxyXG4gKiBSZXR1cm5zIHRoZSBwbHVyYWwgY2FzZSBiYXNlZCBvbiB0aGUgbG9jYWxlXHJcbiAqXHJcbiAqIEBwdWJsaWNBcGlcclxuICovXHJcbnZhciBOZ0xvY2FsZUxvY2FsaXphdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKE5nTG9jYWxlTG9jYWxpemF0aW9uLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gTmdMb2NhbGVMb2NhbGl6YXRpb24obG9jYWxlLCBcclxuICAgIC8qKiBAZGVwcmVjYXRlZCBmcm9tIHY1ICovXHJcbiAgICBkZXByZWNhdGVkUGx1cmFsRm4pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmxvY2FsZSA9IGxvY2FsZTtcclxuICAgICAgICBfdGhpcy5kZXByZWNhdGVkUGx1cmFsRm4gPSBkZXByZWNhdGVkUGx1cmFsRm47XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgTmdMb2NhbGVMb2NhbGl6YXRpb24ucHJvdG90eXBlLmdldFBsdXJhbENhdGVnb3J5ID0gZnVuY3Rpb24gKHZhbHVlLCBsb2NhbGUpIHtcclxuICAgICAgICB2YXIgcGx1cmFsID0gdGhpcy5kZXByZWNhdGVkUGx1cmFsRm4gPyB0aGlzLmRlcHJlY2F0ZWRQbHVyYWxGbihsb2NhbGUgfHwgdGhpcy5sb2NhbGUsIHZhbHVlKSA6XHJcbiAgICAgICAgICAgIGdldExvY2FsZVBsdXJhbENhc2UobG9jYWxlIHx8IHRoaXMubG9jYWxlKSh2YWx1ZSk7XHJcbiAgICAgICAgc3dpdGNoIChwbHVyYWwpIHtcclxuICAgICAgICAgICAgY2FzZSBQbHVyYWwuWmVybzpcclxuICAgICAgICAgICAgICAgIHJldHVybiAnemVybyc7XHJcbiAgICAgICAgICAgIGNhc2UgUGx1cmFsLk9uZTpcclxuICAgICAgICAgICAgICAgIHJldHVybiAnb25lJztcclxuICAgICAgICAgICAgY2FzZSBQbHVyYWwuVHdvOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICd0d28nO1xyXG4gICAgICAgICAgICBjYXNlIFBsdXJhbC5GZXc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ2Zldyc7XHJcbiAgICAgICAgICAgIGNhc2UgUGx1cmFsLk1hbnk6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ21hbnknO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdvdGhlcic7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE5nTG9jYWxlTG9jYWxpemF0aW9uID0gdHNsaWJfMS5fX2RlY29yYXRlKFtcclxuICAgICAgICBJbmplY3RhYmxlKCksXHJcbiAgICAgICAgdHNsaWJfMS5fX3BhcmFtKDAsIEluamVjdChMT0NBTEVfSUQpKSxcclxuICAgICAgICB0c2xpYl8xLl9fcGFyYW0oMSwgT3B0aW9uYWwoKSksIHRzbGliXzEuX19wYXJhbSgxLCBJbmplY3QoREVQUkVDQVRFRF9QTFVSQUxfRk4pKSxcclxuICAgICAgICB0c2xpYl8xLl9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbU3RyaW5nLCBPYmplY3RdKVxyXG4gICAgXSwgTmdMb2NhbGVMb2NhbGl6YXRpb24pO1xyXG4gICAgcmV0dXJuIE5nTG9jYWxlTG9jYWxpemF0aW9uO1xyXG59KE5nTG9jYWxpemF0aW9uKSk7XHJcbmV4cG9ydCB7IE5nTG9jYWxlTG9jYWxpemF0aW9uIH07XHJcbi8qKlxyXG4gKiBSZXR1cm5zIHRoZSBwbHVyYWwgY2FzZSBiYXNlZCBvbiB0aGUgbG9jYWxlXHJcbiAqXHJcbiAqIEBkZXByZWNhdGVkIGZyb20gdjUgdGhlIHBsdXJhbCBjYXNlIGZ1bmN0aW9uIGlzIGluIGxvY2FsZSBkYXRhIGZpbGVzIGNvbW1vbi9sb2NhbGVzLyoudHNcclxuICogQHB1YmxpY0FwaVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFBsdXJhbENhc2UobG9jYWxlLCBuTGlrZSkge1xyXG4gICAgLy8gVE9ETyh2aWNiKTogbGF6eSBjb21wdXRlXHJcbiAgICBpZiAodHlwZW9mIG5MaWtlID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgIG5MaWtlID0gcGFyc2VJbnQobkxpa2UsIDEwKTtcclxuICAgIH1cclxuICAgIHZhciBuID0gbkxpa2U7XHJcbiAgICB2YXIgbkRlY2ltYWwgPSBuLnRvU3RyaW5nKCkucmVwbGFjZSgvXlteLl0qXFwuPy8sICcnKTtcclxuICAgIHZhciBpID0gTWF0aC5mbG9vcihNYXRoLmFicyhuKSk7XHJcbiAgICB2YXIgdiA9IG5EZWNpbWFsLmxlbmd0aDtcclxuICAgIHZhciBmID0gcGFyc2VJbnQobkRlY2ltYWwsIDEwKTtcclxuICAgIHZhciB0ID0gcGFyc2VJbnQobi50b1N0cmluZygpLnJlcGxhY2UoL15bXi5dKlxcLj98MCskL2csICcnKSwgMTApIHx8IDA7XHJcbiAgICB2YXIgbGFuZyA9IGxvY2FsZS5zcGxpdCgnLScpWzBdLnRvTG93ZXJDYXNlKCk7XHJcbiAgICBzd2l0Y2ggKGxhbmcpIHtcclxuICAgICAgICBjYXNlICdhZic6XHJcbiAgICAgICAgY2FzZSAnYXNhJzpcclxuICAgICAgICBjYXNlICdheic6XHJcbiAgICAgICAgY2FzZSAnYmVtJzpcclxuICAgICAgICBjYXNlICdiZXonOlxyXG4gICAgICAgIGNhc2UgJ2JnJzpcclxuICAgICAgICBjYXNlICdicngnOlxyXG4gICAgICAgIGNhc2UgJ2NlJzpcclxuICAgICAgICBjYXNlICdjZ2cnOlxyXG4gICAgICAgIGNhc2UgJ2Nocic6XHJcbiAgICAgICAgY2FzZSAnY2tiJzpcclxuICAgICAgICBjYXNlICdlZSc6XHJcbiAgICAgICAgY2FzZSAnZWwnOlxyXG4gICAgICAgIGNhc2UgJ2VvJzpcclxuICAgICAgICBjYXNlICdlcyc6XHJcbiAgICAgICAgY2FzZSAnZXUnOlxyXG4gICAgICAgIGNhc2UgJ2ZvJzpcclxuICAgICAgICBjYXNlICdmdXInOlxyXG4gICAgICAgIGNhc2UgJ2dzdyc6XHJcbiAgICAgICAgY2FzZSAnaGEnOlxyXG4gICAgICAgIGNhc2UgJ2hhdyc6XHJcbiAgICAgICAgY2FzZSAnaHUnOlxyXG4gICAgICAgIGNhc2UgJ2pnbyc6XHJcbiAgICAgICAgY2FzZSAnam1jJzpcclxuICAgICAgICBjYXNlICdrYSc6XHJcbiAgICAgICAgY2FzZSAna2snOlxyXG4gICAgICAgIGNhc2UgJ2traic6XHJcbiAgICAgICAgY2FzZSAna2wnOlxyXG4gICAgICAgIGNhc2UgJ2tzJzpcclxuICAgICAgICBjYXNlICdrc2InOlxyXG4gICAgICAgIGNhc2UgJ2t5JzpcclxuICAgICAgICBjYXNlICdsYic6XHJcbiAgICAgICAgY2FzZSAnbGcnOlxyXG4gICAgICAgIGNhc2UgJ21hcyc6XHJcbiAgICAgICAgY2FzZSAnbWdvJzpcclxuICAgICAgICBjYXNlICdtbCc6XHJcbiAgICAgICAgY2FzZSAnbW4nOlxyXG4gICAgICAgIGNhc2UgJ25iJzpcclxuICAgICAgICBjYXNlICduZCc6XHJcbiAgICAgICAgY2FzZSAnbmUnOlxyXG4gICAgICAgIGNhc2UgJ25uJzpcclxuICAgICAgICBjYXNlICdubmgnOlxyXG4gICAgICAgIGNhc2UgJ255bic6XHJcbiAgICAgICAgY2FzZSAnb20nOlxyXG4gICAgICAgIGNhc2UgJ29yJzpcclxuICAgICAgICBjYXNlICdvcyc6XHJcbiAgICAgICAgY2FzZSAncHMnOlxyXG4gICAgICAgIGNhc2UgJ3JtJzpcclxuICAgICAgICBjYXNlICdyb2YnOlxyXG4gICAgICAgIGNhc2UgJ3J3ayc6XHJcbiAgICAgICAgY2FzZSAnc2FxJzpcclxuICAgICAgICBjYXNlICdzZWgnOlxyXG4gICAgICAgIGNhc2UgJ3NuJzpcclxuICAgICAgICBjYXNlICdzbyc6XHJcbiAgICAgICAgY2FzZSAnc3EnOlxyXG4gICAgICAgIGNhc2UgJ3RhJzpcclxuICAgICAgICBjYXNlICd0ZSc6XHJcbiAgICAgICAgY2FzZSAndGVvJzpcclxuICAgICAgICBjYXNlICd0ayc6XHJcbiAgICAgICAgY2FzZSAndHInOlxyXG4gICAgICAgIGNhc2UgJ3VnJzpcclxuICAgICAgICBjYXNlICd1eic6XHJcbiAgICAgICAgY2FzZSAndm8nOlxyXG4gICAgICAgIGNhc2UgJ3Z1bic6XHJcbiAgICAgICAgY2FzZSAnd2FlJzpcclxuICAgICAgICBjYXNlICd4b2cnOlxyXG4gICAgICAgICAgICBpZiAobiA9PT0gMSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT25lO1xyXG4gICAgICAgICAgICByZXR1cm4gUGx1cmFsLk90aGVyO1xyXG4gICAgICAgIGNhc2UgJ2FrJzpcclxuICAgICAgICBjYXNlICdsbic6XHJcbiAgICAgICAgY2FzZSAnbWcnOlxyXG4gICAgICAgIGNhc2UgJ3BhJzpcclxuICAgICAgICBjYXNlICd0aSc6XHJcbiAgICAgICAgICAgIGlmIChuID09PSBNYXRoLmZsb29yKG4pICYmIG4gPj0gMCAmJiBuIDw9IDEpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGx1cmFsLk9uZTtcclxuICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5PdGhlcjtcclxuICAgICAgICBjYXNlICdhbSc6XHJcbiAgICAgICAgY2FzZSAnYXMnOlxyXG4gICAgICAgIGNhc2UgJ2JuJzpcclxuICAgICAgICBjYXNlICdmYSc6XHJcbiAgICAgICAgY2FzZSAnZ3UnOlxyXG4gICAgICAgIGNhc2UgJ2hpJzpcclxuICAgICAgICBjYXNlICdrbic6XHJcbiAgICAgICAgY2FzZSAnbXInOlxyXG4gICAgICAgIGNhc2UgJ3p1JzpcclxuICAgICAgICAgICAgaWYgKGkgPT09IDAgfHwgbiA9PT0gMSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT25lO1xyXG4gICAgICAgICAgICByZXR1cm4gUGx1cmFsLk90aGVyO1xyXG4gICAgICAgIGNhc2UgJ2FyJzpcclxuICAgICAgICAgICAgaWYgKG4gPT09IDApXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGx1cmFsLlplcm87XHJcbiAgICAgICAgICAgIGlmIChuID09PSAxKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5PbmU7XHJcbiAgICAgICAgICAgIGlmIChuID09PSAyKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5Ud287XHJcbiAgICAgICAgICAgIGlmIChuICUgMTAwID09PSBNYXRoLmZsb29yKG4gJSAxMDApICYmIG4gJSAxMDAgPj0gMyAmJiBuICUgMTAwIDw9IDEwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5GZXc7XHJcbiAgICAgICAgICAgIGlmIChuICUgMTAwID09PSBNYXRoLmZsb29yKG4gJSAxMDApICYmIG4gJSAxMDAgPj0gMTEgJiYgbiAlIDEwMCA8PSA5OSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuTWFueTtcclxuICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5PdGhlcjtcclxuICAgICAgICBjYXNlICdhc3QnOlxyXG4gICAgICAgIGNhc2UgJ2NhJzpcclxuICAgICAgICBjYXNlICdkZSc6XHJcbiAgICAgICAgY2FzZSAnZW4nOlxyXG4gICAgICAgIGNhc2UgJ2V0JzpcclxuICAgICAgICBjYXNlICdmaSc6XHJcbiAgICAgICAgY2FzZSAnZnknOlxyXG4gICAgICAgIGNhc2UgJ2dsJzpcclxuICAgICAgICBjYXNlICdpdCc6XHJcbiAgICAgICAgY2FzZSAnbmwnOlxyXG4gICAgICAgIGNhc2UgJ3N2JzpcclxuICAgICAgICBjYXNlICdzdyc6XHJcbiAgICAgICAgY2FzZSAndXInOlxyXG4gICAgICAgIGNhc2UgJ3lpJzpcclxuICAgICAgICAgICAgaWYgKGkgPT09IDEgJiYgdiA9PT0gMClcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT25lO1xyXG4gICAgICAgICAgICByZXR1cm4gUGx1cmFsLk90aGVyO1xyXG4gICAgICAgIGNhc2UgJ2JlJzpcclxuICAgICAgICAgICAgaWYgKG4gJSAxMCA9PT0gMSAmJiAhKG4gJSAxMDAgPT09IDExKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT25lO1xyXG4gICAgICAgICAgICBpZiAobiAlIDEwID09PSBNYXRoLmZsb29yKG4gJSAxMCkgJiYgbiAlIDEwID49IDIgJiYgbiAlIDEwIDw9IDQgJiZcclxuICAgICAgICAgICAgICAgICEobiAlIDEwMCA+PSAxMiAmJiBuICUgMTAwIDw9IDE0KSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuRmV3O1xyXG4gICAgICAgICAgICBpZiAobiAlIDEwID09PSAwIHx8IG4gJSAxMCA9PT0gTWF0aC5mbG9vcihuICUgMTApICYmIG4gJSAxMCA+PSA1ICYmIG4gJSAxMCA8PSA5IHx8XHJcbiAgICAgICAgICAgICAgICBuICUgMTAwID09PSBNYXRoLmZsb29yKG4gJSAxMDApICYmIG4gJSAxMDAgPj0gMTEgJiYgbiAlIDEwMCA8PSAxNClcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuTWFueTtcclxuICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5PdGhlcjtcclxuICAgICAgICBjYXNlICdicic6XHJcbiAgICAgICAgICAgIGlmIChuICUgMTAgPT09IDEgJiYgIShuICUgMTAwID09PSAxMSB8fCBuICUgMTAwID09PSA3MSB8fCBuICUgMTAwID09PSA5MSkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGx1cmFsLk9uZTtcclxuICAgICAgICAgICAgaWYgKG4gJSAxMCA9PT0gMiAmJiAhKG4gJSAxMDAgPT09IDEyIHx8IG4gJSAxMDAgPT09IDcyIHx8IG4gJSAxMDAgPT09IDkyKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuVHdvO1xyXG4gICAgICAgICAgICBpZiAobiAlIDEwID09PSBNYXRoLmZsb29yKG4gJSAxMCkgJiYgKG4gJSAxMCA+PSAzICYmIG4gJSAxMCA8PSA0IHx8IG4gJSAxMCA9PT0gOSkgJiZcclxuICAgICAgICAgICAgICAgICEobiAlIDEwMCA+PSAxMCAmJiBuICUgMTAwIDw9IDE5IHx8IG4gJSAxMDAgPj0gNzAgJiYgbiAlIDEwMCA8PSA3OSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIG4gJSAxMDAgPj0gOTAgJiYgbiAlIDEwMCA8PSA5OSkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGx1cmFsLkZldztcclxuICAgICAgICAgICAgaWYgKCEobiA9PT0gMCkgJiYgbiAlIDFlNiA9PT0gMClcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuTWFueTtcclxuICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5PdGhlcjtcclxuICAgICAgICBjYXNlICdicyc6XHJcbiAgICAgICAgY2FzZSAnaHInOlxyXG4gICAgICAgIGNhc2UgJ3NyJzpcclxuICAgICAgICAgICAgaWYgKHYgPT09IDAgJiYgaSAlIDEwID09PSAxICYmICEoaSAlIDEwMCA9PT0gMTEpIHx8IGYgJSAxMCA9PT0gMSAmJiAhKGYgJSAxMDAgPT09IDExKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT25lO1xyXG4gICAgICAgICAgICBpZiAodiA9PT0gMCAmJiBpICUgMTAgPT09IE1hdGguZmxvb3IoaSAlIDEwKSAmJiBpICUgMTAgPj0gMiAmJiBpICUgMTAgPD0gNCAmJlxyXG4gICAgICAgICAgICAgICAgIShpICUgMTAwID49IDEyICYmIGkgJSAxMDAgPD0gMTQpIHx8XHJcbiAgICAgICAgICAgICAgICBmICUgMTAgPT09IE1hdGguZmxvb3IoZiAlIDEwKSAmJiBmICUgMTAgPj0gMiAmJiBmICUgMTAgPD0gNCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICEoZiAlIDEwMCA+PSAxMiAmJiBmICUgMTAwIDw9IDE0KSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuRmV3O1xyXG4gICAgICAgICAgICByZXR1cm4gUGx1cmFsLk90aGVyO1xyXG4gICAgICAgIGNhc2UgJ2NzJzpcclxuICAgICAgICBjYXNlICdzayc6XHJcbiAgICAgICAgICAgIGlmIChpID09PSAxICYmIHYgPT09IDApXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGx1cmFsLk9uZTtcclxuICAgICAgICAgICAgaWYgKGkgPT09IE1hdGguZmxvb3IoaSkgJiYgaSA+PSAyICYmIGkgPD0gNCAmJiB2ID09PSAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5GZXc7XHJcbiAgICAgICAgICAgIGlmICghKHYgPT09IDApKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5NYW55O1xyXG4gICAgICAgICAgICByZXR1cm4gUGx1cmFsLk90aGVyO1xyXG4gICAgICAgIGNhc2UgJ2N5JzpcclxuICAgICAgICAgICAgaWYgKG4gPT09IDApXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGx1cmFsLlplcm87XHJcbiAgICAgICAgICAgIGlmIChuID09PSAxKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5PbmU7XHJcbiAgICAgICAgICAgIGlmIChuID09PSAyKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5Ud287XHJcbiAgICAgICAgICAgIGlmIChuID09PSAzKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5GZXc7XHJcbiAgICAgICAgICAgIGlmIChuID09PSA2KVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5NYW55O1xyXG4gICAgICAgICAgICByZXR1cm4gUGx1cmFsLk90aGVyO1xyXG4gICAgICAgIGNhc2UgJ2RhJzpcclxuICAgICAgICAgICAgaWYgKG4gPT09IDEgfHwgISh0ID09PSAwKSAmJiAoaSA9PT0gMCB8fCBpID09PSAxKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT25lO1xyXG4gICAgICAgICAgICByZXR1cm4gUGx1cmFsLk90aGVyO1xyXG4gICAgICAgIGNhc2UgJ2RzYic6XHJcbiAgICAgICAgY2FzZSAnaHNiJzpcclxuICAgICAgICAgICAgaWYgKHYgPT09IDAgJiYgaSAlIDEwMCA9PT0gMSB8fCBmICUgMTAwID09PSAxKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5PbmU7XHJcbiAgICAgICAgICAgIGlmICh2ID09PSAwICYmIGkgJSAxMDAgPT09IDIgfHwgZiAlIDEwMCA9PT0gMilcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuVHdvO1xyXG4gICAgICAgICAgICBpZiAodiA9PT0gMCAmJiBpICUgMTAwID09PSBNYXRoLmZsb29yKGkgJSAxMDApICYmIGkgJSAxMDAgPj0gMyAmJiBpICUgMTAwIDw9IDQgfHxcclxuICAgICAgICAgICAgICAgIGYgJSAxMDAgPT09IE1hdGguZmxvb3IoZiAlIDEwMCkgJiYgZiAlIDEwMCA+PSAzICYmIGYgJSAxMDAgPD0gNClcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuRmV3O1xyXG4gICAgICAgICAgICByZXR1cm4gUGx1cmFsLk90aGVyO1xyXG4gICAgICAgIGNhc2UgJ2ZmJzpcclxuICAgICAgICBjYXNlICdmcic6XHJcbiAgICAgICAgY2FzZSAnaHknOlxyXG4gICAgICAgIGNhc2UgJ2thYic6XHJcbiAgICAgICAgICAgIGlmIChpID09PSAwIHx8IGkgPT09IDEpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGx1cmFsLk9uZTtcclxuICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5PdGhlcjtcclxuICAgICAgICBjYXNlICdmaWwnOlxyXG4gICAgICAgICAgICBpZiAodiA9PT0gMCAmJiAoaSA9PT0gMSB8fCBpID09PSAyIHx8IGkgPT09IDMpIHx8XHJcbiAgICAgICAgICAgICAgICB2ID09PSAwICYmICEoaSAlIDEwID09PSA0IHx8IGkgJSAxMCA9PT0gNiB8fCBpICUgMTAgPT09IDkpIHx8XHJcbiAgICAgICAgICAgICAgICAhKHYgPT09IDApICYmICEoZiAlIDEwID09PSA0IHx8IGYgJSAxMCA9PT0gNiB8fCBmICUgMTAgPT09IDkpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5PbmU7XHJcbiAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT3RoZXI7XHJcbiAgICAgICAgY2FzZSAnZ2EnOlxyXG4gICAgICAgICAgICBpZiAobiA9PT0gMSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT25lO1xyXG4gICAgICAgICAgICBpZiAobiA9PT0gMilcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuVHdvO1xyXG4gICAgICAgICAgICBpZiAobiA9PT0gTWF0aC5mbG9vcihuKSAmJiBuID49IDMgJiYgbiA8PSA2KVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5GZXc7XHJcbiAgICAgICAgICAgIGlmIChuID09PSBNYXRoLmZsb29yKG4pICYmIG4gPj0gNyAmJiBuIDw9IDEwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5NYW55O1xyXG4gICAgICAgICAgICByZXR1cm4gUGx1cmFsLk90aGVyO1xyXG4gICAgICAgIGNhc2UgJ2dkJzpcclxuICAgICAgICAgICAgaWYgKG4gPT09IDEgfHwgbiA9PT0gMTEpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGx1cmFsLk9uZTtcclxuICAgICAgICAgICAgaWYgKG4gPT09IDIgfHwgbiA9PT0gMTIpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGx1cmFsLlR3bztcclxuICAgICAgICAgICAgaWYgKG4gPT09IE1hdGguZmxvb3IobikgJiYgKG4gPj0gMyAmJiBuIDw9IDEwIHx8IG4gPj0gMTMgJiYgbiA8PSAxOSkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGx1cmFsLkZldztcclxuICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5PdGhlcjtcclxuICAgICAgICBjYXNlICdndic6XHJcbiAgICAgICAgICAgIGlmICh2ID09PSAwICYmIGkgJSAxMCA9PT0gMSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT25lO1xyXG4gICAgICAgICAgICBpZiAodiA9PT0gMCAmJiBpICUgMTAgPT09IDIpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGx1cmFsLlR3bztcclxuICAgICAgICAgICAgaWYgKHYgPT09IDAgJiZcclxuICAgICAgICAgICAgICAgIChpICUgMTAwID09PSAwIHx8IGkgJSAxMDAgPT09IDIwIHx8IGkgJSAxMDAgPT09IDQwIHx8IGkgJSAxMDAgPT09IDYwIHx8IGkgJSAxMDAgPT09IDgwKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuRmV3O1xyXG4gICAgICAgICAgICBpZiAoISh2ID09PSAwKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuTWFueTtcclxuICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5PdGhlcjtcclxuICAgICAgICBjYXNlICdoZSc6XHJcbiAgICAgICAgICAgIGlmIChpID09PSAxICYmIHYgPT09IDApXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGx1cmFsLk9uZTtcclxuICAgICAgICAgICAgaWYgKGkgPT09IDIgJiYgdiA9PT0gMClcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuVHdvO1xyXG4gICAgICAgICAgICBpZiAodiA9PT0gMCAmJiAhKG4gPj0gMCAmJiBuIDw9IDEwKSAmJiBuICUgMTAgPT09IDApXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGx1cmFsLk1hbnk7XHJcbiAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT3RoZXI7XHJcbiAgICAgICAgY2FzZSAnaXMnOlxyXG4gICAgICAgICAgICBpZiAodCA9PT0gMCAmJiBpICUgMTAgPT09IDEgJiYgIShpICUgMTAwID09PSAxMSkgfHwgISh0ID09PSAwKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT25lO1xyXG4gICAgICAgICAgICByZXR1cm4gUGx1cmFsLk90aGVyO1xyXG4gICAgICAgIGNhc2UgJ2tzaCc6XHJcbiAgICAgICAgICAgIGlmIChuID09PSAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5aZXJvO1xyXG4gICAgICAgICAgICBpZiAobiA9PT0gMSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT25lO1xyXG4gICAgICAgICAgICByZXR1cm4gUGx1cmFsLk90aGVyO1xyXG4gICAgICAgIGNhc2UgJ2t3JzpcclxuICAgICAgICBjYXNlICduYXEnOlxyXG4gICAgICAgIGNhc2UgJ3NlJzpcclxuICAgICAgICBjYXNlICdzbW4nOlxyXG4gICAgICAgICAgICBpZiAobiA9PT0gMSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT25lO1xyXG4gICAgICAgICAgICBpZiAobiA9PT0gMilcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuVHdvO1xyXG4gICAgICAgICAgICByZXR1cm4gUGx1cmFsLk90aGVyO1xyXG4gICAgICAgIGNhc2UgJ2xhZyc6XHJcbiAgICAgICAgICAgIGlmIChuID09PSAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5aZXJvO1xyXG4gICAgICAgICAgICBpZiAoKGkgPT09IDAgfHwgaSA9PT0gMSkgJiYgIShuID09PSAwKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT25lO1xyXG4gICAgICAgICAgICByZXR1cm4gUGx1cmFsLk90aGVyO1xyXG4gICAgICAgIGNhc2UgJ2x0JzpcclxuICAgICAgICAgICAgaWYgKG4gJSAxMCA9PT0gMSAmJiAhKG4gJSAxMDAgPj0gMTEgJiYgbiAlIDEwMCA8PSAxOSkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGx1cmFsLk9uZTtcclxuICAgICAgICAgICAgaWYgKG4gJSAxMCA9PT0gTWF0aC5mbG9vcihuICUgMTApICYmIG4gJSAxMCA+PSAyICYmIG4gJSAxMCA8PSA5ICYmXHJcbiAgICAgICAgICAgICAgICAhKG4gJSAxMDAgPj0gMTEgJiYgbiAlIDEwMCA8PSAxOSkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGx1cmFsLkZldztcclxuICAgICAgICAgICAgaWYgKCEoZiA9PT0gMCkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGx1cmFsLk1hbnk7XHJcbiAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT3RoZXI7XHJcbiAgICAgICAgY2FzZSAnbHYnOlxyXG4gICAgICAgIGNhc2UgJ3ByZyc6XHJcbiAgICAgICAgICAgIGlmIChuICUgMTAgPT09IDAgfHwgbiAlIDEwMCA9PT0gTWF0aC5mbG9vcihuICUgMTAwKSAmJiBuICUgMTAwID49IDExICYmIG4gJSAxMDAgPD0gMTkgfHxcclxuICAgICAgICAgICAgICAgIHYgPT09IDIgJiYgZiAlIDEwMCA9PT0gTWF0aC5mbG9vcihmICUgMTAwKSAmJiBmICUgMTAwID49IDExICYmIGYgJSAxMDAgPD0gMTkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGx1cmFsLlplcm87XHJcbiAgICAgICAgICAgIGlmIChuICUgMTAgPT09IDEgJiYgIShuICUgMTAwID09PSAxMSkgfHwgdiA9PT0gMiAmJiBmICUgMTAgPT09IDEgJiYgIShmICUgMTAwID09PSAxMSkgfHxcclxuICAgICAgICAgICAgICAgICEodiA9PT0gMikgJiYgZiAlIDEwID09PSAxKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5PbmU7XHJcbiAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT3RoZXI7XHJcbiAgICAgICAgY2FzZSAnbWsnOlxyXG4gICAgICAgICAgICBpZiAodiA9PT0gMCAmJiBpICUgMTAgPT09IDEgfHwgZiAlIDEwID09PSAxKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5PbmU7XHJcbiAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT3RoZXI7XHJcbiAgICAgICAgY2FzZSAnbXQnOlxyXG4gICAgICAgICAgICBpZiAobiA9PT0gMSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT25lO1xyXG4gICAgICAgICAgICBpZiAobiA9PT0gMCB8fCBuICUgMTAwID09PSBNYXRoLmZsb29yKG4gJSAxMDApICYmIG4gJSAxMDAgPj0gMiAmJiBuICUgMTAwIDw9IDEwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5GZXc7XHJcbiAgICAgICAgICAgIGlmIChuICUgMTAwID09PSBNYXRoLmZsb29yKG4gJSAxMDApICYmIG4gJSAxMDAgPj0gMTEgJiYgbiAlIDEwMCA8PSAxOSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuTWFueTtcclxuICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5PdGhlcjtcclxuICAgICAgICBjYXNlICdwbCc6XHJcbiAgICAgICAgICAgIGlmIChpID09PSAxICYmIHYgPT09IDApXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGx1cmFsLk9uZTtcclxuICAgICAgICAgICAgaWYgKHYgPT09IDAgJiYgaSAlIDEwID09PSBNYXRoLmZsb29yKGkgJSAxMCkgJiYgaSAlIDEwID49IDIgJiYgaSAlIDEwIDw9IDQgJiZcclxuICAgICAgICAgICAgICAgICEoaSAlIDEwMCA+PSAxMiAmJiBpICUgMTAwIDw9IDE0KSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuRmV3O1xyXG4gICAgICAgICAgICBpZiAodiA9PT0gMCAmJiAhKGkgPT09IDEpICYmIGkgJSAxMCA9PT0gTWF0aC5mbG9vcihpICUgMTApICYmIGkgJSAxMCA+PSAwICYmIGkgJSAxMCA8PSAxIHx8XHJcbiAgICAgICAgICAgICAgICB2ID09PSAwICYmIGkgJSAxMCA9PT0gTWF0aC5mbG9vcihpICUgMTApICYmIGkgJSAxMCA+PSA1ICYmIGkgJSAxMCA8PSA5IHx8XHJcbiAgICAgICAgICAgICAgICB2ID09PSAwICYmIGkgJSAxMDAgPT09IE1hdGguZmxvb3IoaSAlIDEwMCkgJiYgaSAlIDEwMCA+PSAxMiAmJiBpICUgMTAwIDw9IDE0KVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5NYW55O1xyXG4gICAgICAgICAgICByZXR1cm4gUGx1cmFsLk90aGVyO1xyXG4gICAgICAgIGNhc2UgJ3B0JzpcclxuICAgICAgICAgICAgaWYgKG4gPT09IE1hdGguZmxvb3IobikgJiYgbiA+PSAwICYmIG4gPD0gMiAmJiAhKG4gPT09IDIpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5PbmU7XHJcbiAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT3RoZXI7XHJcbiAgICAgICAgY2FzZSAncm8nOlxyXG4gICAgICAgICAgICBpZiAoaSA9PT0gMSAmJiB2ID09PSAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5PbmU7XHJcbiAgICAgICAgICAgIGlmICghKHYgPT09IDApIHx8IG4gPT09IDAgfHxcclxuICAgICAgICAgICAgICAgICEobiA9PT0gMSkgJiYgbiAlIDEwMCA9PT0gTWF0aC5mbG9vcihuICUgMTAwKSAmJiBuICUgMTAwID49IDEgJiYgbiAlIDEwMCA8PSAxOSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuRmV3O1xyXG4gICAgICAgICAgICByZXR1cm4gUGx1cmFsLk90aGVyO1xyXG4gICAgICAgIGNhc2UgJ3J1JzpcclxuICAgICAgICBjYXNlICd1ayc6XHJcbiAgICAgICAgICAgIGlmICh2ID09PSAwICYmIGkgJSAxMCA9PT0gMSAmJiAhKGkgJSAxMDAgPT09IDExKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT25lO1xyXG4gICAgICAgICAgICBpZiAodiA9PT0gMCAmJiBpICUgMTAgPT09IE1hdGguZmxvb3IoaSAlIDEwKSAmJiBpICUgMTAgPj0gMiAmJiBpICUgMTAgPD0gNCAmJlxyXG4gICAgICAgICAgICAgICAgIShpICUgMTAwID49IDEyICYmIGkgJSAxMDAgPD0gMTQpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5GZXc7XHJcbiAgICAgICAgICAgIGlmICh2ID09PSAwICYmIGkgJSAxMCA9PT0gMCB8fFxyXG4gICAgICAgICAgICAgICAgdiA9PT0gMCAmJiBpICUgMTAgPT09IE1hdGguZmxvb3IoaSAlIDEwKSAmJiBpICUgMTAgPj0gNSAmJiBpICUgMTAgPD0gOSB8fFxyXG4gICAgICAgICAgICAgICAgdiA9PT0gMCAmJiBpICUgMTAwID09PSBNYXRoLmZsb29yKGkgJSAxMDApICYmIGkgJSAxMDAgPj0gMTEgJiYgaSAlIDEwMCA8PSAxNClcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuTWFueTtcclxuICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5PdGhlcjtcclxuICAgICAgICBjYXNlICdzaGknOlxyXG4gICAgICAgICAgICBpZiAoaSA9PT0gMCB8fCBuID09PSAxKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5PbmU7XHJcbiAgICAgICAgICAgIGlmIChuID09PSBNYXRoLmZsb29yKG4pICYmIG4gPj0gMiAmJiBuIDw9IDEwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5GZXc7XHJcbiAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT3RoZXI7XHJcbiAgICAgICAgY2FzZSAnc2knOlxyXG4gICAgICAgICAgICBpZiAobiA9PT0gMCB8fCBuID09PSAxIHx8IGkgPT09IDAgJiYgZiA9PT0gMSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT25lO1xyXG4gICAgICAgICAgICByZXR1cm4gUGx1cmFsLk90aGVyO1xyXG4gICAgICAgIGNhc2UgJ3NsJzpcclxuICAgICAgICAgICAgaWYgKHYgPT09IDAgJiYgaSAlIDEwMCA9PT0gMSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT25lO1xyXG4gICAgICAgICAgICBpZiAodiA9PT0gMCAmJiBpICUgMTAwID09PSAyKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5Ud287XHJcbiAgICAgICAgICAgIGlmICh2ID09PSAwICYmIGkgJSAxMDAgPT09IE1hdGguZmxvb3IoaSAlIDEwMCkgJiYgaSAlIDEwMCA+PSAzICYmIGkgJSAxMDAgPD0gNCB8fCAhKHYgPT09IDApKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBsdXJhbC5GZXc7XHJcbiAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT3RoZXI7XHJcbiAgICAgICAgY2FzZSAndHptJzpcclxuICAgICAgICAgICAgaWYgKG4gPT09IE1hdGguZmxvb3IobikgJiYgbiA+PSAwICYmIG4gPD0gMSB8fCBuID09PSBNYXRoLmZsb29yKG4pICYmIG4gPj0gMTEgJiYgbiA8PSA5OSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBQbHVyYWwuT25lO1xyXG4gICAgICAgICAgICByZXR1cm4gUGx1cmFsLk90aGVyO1xyXG4gICAgICAgIC8vIFdoZW4gdGhlcmUgaXMgbm8gc3BlY2lmaWNhdGlvbiwgdGhlIGRlZmF1bHQgaXMgYWx3YXlzIFwib3RoZXJcIlxyXG4gICAgICAgIC8vIFNwZWM6IGh0dHA6Ly9jbGRyLnVuaWNvZGUub3JnL2luZGV4L2NsZHItc3BlYy9wbHVyYWwtcnVsZXNcclxuICAgICAgICAvLyA+IG90aGVyIChyZXF1aXJlZOKAlGdlbmVyYWwgcGx1cmFsIGZvcm0g4oCUIGFsc28gdXNlZCBpZiB0aGUgbGFuZ3VhZ2Ugb25seSBoYXMgYSBzaW5nbGUgZm9ybSlcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICByZXR1cm4gUGx1cmFsLk90aGVyO1xyXG4gICAgfVxyXG59XHIiXX0=